import{e,g as l,j as a,q as t,x as o,a2 as r,V as s,c as n,h as u,ac as i,a as c,aE as d,w as v,d as p,r as m,p as f,i as y,aF as b,aC as g,F as k,C as w,A as h,L as x,u as C,H as j,y as V,v as T,l as S,I as $,D as _}from"../../index-BnGzoMia.js";const H=["data-th"],O=r(e({__name:"VFlexTableCell",props:{column:{default:()=>({})}},setup(e){const r=e;return(e,s)=>(l(),a("div",{class:o(["flex-table-cell is-relative",[r.column.bold&&"is-bold",r.column.media&&"is-media",!0===r.column.grow&&"is-grow","lg"===r.column.grow&&"is-grow-lg","xl"===r.column.grow&&"is-grow-xl",r.column.scrollX&&!r.column.scrollY&&"has-slimscroll-x",!r.column.scrollX&&r.column.scrollY&&"has-slimscroll",r.column.scrollX&&r.column.scrollY&&"has-slimscroll-all","end"===r.column.align&&"cell-end","center"===r.column.align&&"cell-center",r.column.cellClass]]),"data-th":r.column.label||void 0},[t(e.$slots,"default")],10,H))}}),[["__file","VFlexTableCell.vue"]]),B=r(e({props:{id:{type:String,required:!0},label:{type:String,default:void 0},modelValue:{type:String,default:void 0},noRouter:{type:Boolean,default:void 0},routerQueryKey:{type:String,default:"sort"}},slots:Object,emits:["update:modelValue"],setup(e,l){const a=s(),t=n((()=>e.modelValue??a.query[e.routerQueryKey]??"")),o=n((()=>t.value===`${e.id}:asc`)),r=n((()=>t.value===`${e.id}:desc`)),c=n((()=>o.value?`${e.id}:desc`:r.value?void 0:`${e.id}:asc`)),d=n((()=>{if(e.noRouter)return{};const l={...a.query};return e.routerQueryKey&&(l[e.routerQueryKey]=c.value),{name:a.name,params:a.params,query:l}})),v=a=>{if(l.emit("update:modelValue",c.value),e.noRouter)return a.preventDefault(),a.stopPropagation(),!1};return()=>{const a=l.slots?.default?.({isDesc:r.value,isAsc:o.value,nextSort:c.value,value:t.value}),s=u(i,{to:d.value,onClick:v,onKeydown(e){"Space"===e.code&&(e.preventDefault(),e.stopPropagation(),e.target instanceof HTMLAnchorElement&&e.target.dispatchEvent(new MouseEvent("click")))}},{default(){const l=u("iconify-icon",{class:"ml-3 iconify",icon:o.value?"fa6-solid:sort-up":r.value?"fa6-solid:sort-down":"fa6-solid:sort"});return[a??e.label,l]}});return u("span",{},s)}}}),[["__file","VFlexTableSortColumn.vue"]]),F=Symbol(),R=e=>e,K=({key:e,order:l,a:a,b:t})=>{const o=a[e],r=t[e];return"string"==typeof o?"asc"===l?o.localeCompare(r):r.localeCompare(o):o>r?"asc"===l?1:-1:o<r?"asc"===l?-1:1:0},q=e({props:{data:{type:[Array,Function],default:void 0},columns:{type:Object,default:void 0},sort:{type:String,default:void 0},searchTerm:{type:String,default:void 0},limit:{type:Number,default:void 0},page:{type:Number,default:void 0},total:{type:Number,default:void 0},debounceSearch:{type:Number,default:300}},slots:Object,emits:["update:sort","update:page","update:limit","update:searchTerm"],setup(e,l){const a=c(),t=c(!1),o=c(""),r=n({get:()=>e.sort??o.value,set(a){void 0===e.sort?o.value=a:l.emit("update:sort",a)}}),s=c(""),i=n({get:()=>e.searchTerm??s.value,set(a){void 0===e.searchTerm?s.value=a:l.emit("update:searchTerm",a)}}),y=c(1),b=n({get:()=>e.page??y.value,set(a){void 0===e.page?y.value=a:l.emit("update:page",a)}}),g=c(10),k=n({get:()=>Math.max(1,e.limit??g.value),set(a){void 0===e.limit?g.value=a:l.emit("update:limit",a)}}),w=n((()=>{const l=e.columns;if(!l)return l;const a={};return Object.keys(l).reduce(((e,a)=>{const t=l[a];return"string"==typeof t?e[a]={format:R,label:t,key:a}:"object"==typeof t&&(e[a]={format:R,label:a,key:a,...t},!0===t.sortable&&(t.renderHeader?e[a].renderHeader=()=>u(B,{id:a,noRouter:!0,modelValue:r.value,"onUpdate:modelValue":e=>r.value=e},{default:t.renderHeader}):e[a].renderHeader=()=>u(B,{id:a,label:t.label??a,noRouter:!0,modelValue:r.value,"onUpdate:modelValue":e=>r.value=e})),!0!==t.searchable||t.sort||(e[a].sort=K)),e}),a),a})),h=n((()=>{let l=a.value;if(!l)return l;if("function"==typeof e.data)return l;if(j.value){const e=w.value?Object.values(w.value).filter((e=>!(!e||"string"==typeof e)&&!0===e.searchable)):[];if(e.length){const a=new RegExp(j.value,"i");l=l.filter(((l,t)=>e.some((e=>{if(!e.key)return!1;const o=l[e.key];return e.filter?e.filter({searchTerm:j.value,value:o,row:l,column:e,index:t}):"string"==typeof o&&o.match(a)}))))}}return l})),x=n((()=>{let l=h.value;if(!l)return l;if("function"==typeof e.data)return l;if(r.value&&r.value.includes(":")){const[e,a]=r.value.split(":"),t=w.value?Object.values(w.value).find((l=>!(!l||"string"==typeof l)&&(!0===l.sortable&&l.key===e))):null;if(t){const e=[...l];e.sort(((e,l)=>t.key&&t.sort?t.sort({order:a,column:t,key:t.key,a:e,b:l}):0)),l=e}}return l})),C=n((()=>{if("function"==typeof e.data)return a.value;if(!a.value)return a.value;let l=x.value;return l?.slice(T.value,T.value+k.value)})),j=d(i,e.debounceSearch),V=n((()=>e.total??x.value?.length??0)),T=n((()=>(b.value-1)*k.value)),S=n((()=>V.value?Math.ceil(V.value/k.value):0));async function $(l){if("function"==typeof e.data){t.value=!0;try{a.value=await e.data({searchTerm:j.value,start:T.value,limit:k.value,sort:r.value,controller:l})}finally{t.value=!1}}}v([j,k],(()=>{1!==b.value&&(b.value=1)})),p((async l=>{let t;"function"==typeof e.data?(t=new AbortController,await $(t)):a.value=e.data,l((()=>{t?.abort()}))}));const _=m({data:C,columns:w,loading:t,searchInput:i,searchTerm:j,start:T,page:b,limit:k,sort:r,total:V,totalPages:S,fetchData:$});return f(F,_),l.expose(_),()=>{const e=l.slots.default?.(_);return u("div",{class:"flex-table-wrapper"},e)}}}),A={key:0,class:"flex-table-header"},D=["tabindex","role","onKeydown","onClick"],E={key:0},M={class:"language-json py-4"},N=e({__name:"VFlexTable",props:{data:{default:()=>[]},columns:{default:void 0},printObjects:{type:Boolean},reactive:{type:Boolean},compact:{type:Boolean},rounded:{type:Boolean},separators:{type:Boolean},clickable:{type:Boolean},subtable:{type:Boolean},noHeader:{type:Boolean}},emits:["rowClick"],setup(e,{emit:r}){const s=r,u=e,i=y(F,null),c=n((()=>i?.data?i.data:u.reactive?b(u.data)?u.data:m(u.data):g(u.data))),d=e=>e,v=n((()=>{const e=i?.columns??u.columns;let l=[];if(e)for(const[a,t]of Object.entries(e))"string"==typeof t?l.push({format:d,label:t,key:a}):l.push({format:d,label:a,key:a,...t});else if(c.value.length>0)for(const[a]of Object.entries(c.value[0]))l.push({format:d,label:a,key:a});return l}));return(e,r)=>{const n=O;return l(),a("div",{class:o(["flex-table",[u.compact&&"is-compact",u.rounded&&"is-rounded",u.separators&&"with-separators",u.noHeader&&"no-header",u.clickable&&"is-table-clickable",u.subtable&&"sub-table"]])},[t(e.$slots,"header",{},(()=>[u.noHeader?V("",!0):(l(),a("div",A,[(l(!0),a(k,null,w(j(v),(r=>t(e.$slots,"header-column",{key:"col"+r.key,column:r},(()=>[r.renderHeader?(l(),h(x({render:r.renderHeader}),{key:0,class:o([!0===r.grow&&"is-grow","lg"===r.grow&&"is-grow-lg","xl"===r.grow&&"is-grow-xl","end"===r.align&&"cell-end","center"===r.align&&"cell-center"])},null,8,["class"])):(l(),a("span",{key:1,class:o([!0===r.grow&&"is-grow","lg"===r.grow&&"is-grow-lg","xl"===r.grow&&"is-grow-xl","end"===r.align&&"cell-end","center"===r.align&&"cell-center"])},C(r.label),3))])))),128))]))])),t(e.$slots,"body",{},(()=>[(l(!0),a(k,null,w(j(c),((r,i)=>(l(),a(k,{key:i},[t(e.$slots,"body-row-pre",{row:r,columns:j(v),index:i}),T("div",{class:o(["flex-table-item",[u.clickable&&"is-clickable"]]),tabindex:u.clickable?0:void 0,role:u.clickable?"button":void 0,onKeydown:$(_((()=>{u.clickable&&s("rowClick",r,i)}),["prevent"]),["enter"]),onClick:()=>{u.clickable&&s("rowClick",r,i)}},[t(e.$slots,"body-row",{row:r,columns:j(v),index:i},(()=>[(l(!0),a(k,null,w(j(v),(s=>(l(),h(n,{key:"row"+s.key,column:s},{default:S((()=>[t(e.$slots,"body-cell",{row:r,column:s,index:i,value:s.format(r[s.key],r,i)},(()=>[s.renderRow?(l(),h(x({render:()=>s.renderRow?.(r,s,i)}),{key:0})):"object"==typeof s.format(r[s.key],r,i)?(l(),a("span",{key:1,class:o([s.cellClass,s.inverted&&"dark-inverted",!s.inverted&&(s.bold?"dark-text":"light-text")])},[e.printObjects?(l(),a("details",E,[T("div",M,[T("pre",null,[T("code",null,C(s.format(r[s.key],r,i)),1)])])])):V("",!0)],2)):(l(),a("span",{key:2,class:o([s.cellClass,s.inverted&&"dark-inverted",!s.inverted&&(s.bold?"dark-text":"light-text")])},C(s.format(r[s.key],r,i)),3))]))])),_:2},1032,["column"])))),128))]))],42,D),t(e.$slots,"body-row-post",{row:r,columns:j(v),index:i})],64)))),128))]))],2)}}}),Q=r(N,[["__file","VFlexTable.vue"]]);export{B as V,Q as _,q as a,O as b};
