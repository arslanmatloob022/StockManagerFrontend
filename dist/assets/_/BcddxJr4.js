import{d as e}from"./BFnVcjcj.js";import{e as o,f as t}from"./D_4wJL3I.js";import{X as s}from"../../index-BBZ1hd8o.js";class r extends Error{constructor(e,o){super(e,o),this.name="FetchError",o?.cause&&!this.cause&&(this.cause=o.cause)}}const n=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function a(e="GET"){return n.has(e.toUpperCase())}const i=new Set(["image/svg","application/xml","application/xhtml","application/html"]),p=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function u(e,o,t=globalThis.Headers){const s={...o,...e};if(o?.params&&e?.params&&(s.params={...o?.params,...e?.params}),o?.query&&e?.query&&(s.query={...o?.query,...e?.query}),o?.headers&&e?.headers){s.headers=new t(o?.headers||{});for(const[o,r]of new t(e?.headers||{}))s.headers.set(o,r)}return s}const c=new Set([408,409,425,429,500,502,503,504]),d=new Set([101,204,205,304]);const f=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}(),l=function s(n={}){const{fetch:f=globalThis.fetch,Headers:l=globalThis.Headers,AbortController:h=globalThis.AbortController}=n;async function y(e){const o=e.error&&"AbortError"===e.error.name&&!e.options.timeout||!1;if(!1!==e.options.retry&&!o){let o;o="number"==typeof e.options.retry?e.options.retry:a(e.options.method)?0:1;const t=e.response&&e.response.status||500;if(o>0&&(Array.isArray(e.options.retryStatusCodes)?e.options.retryStatusCodes.includes(t):c.has(t))){const t=e.options.retryDelay||0;return t>0&&await new Promise((e=>setTimeout(e,t))),b(e.request,{...e.options,retry:o-1})}}const t=function(e){const o=e.error?.message||e.error?.toString()||"",t=e.request?.method||e.options?.method||"GET",s=e.request?.url||String(e.request)||"/",n=`[${t}] ${JSON.stringify(s)}`,a=e.response?`${e.response.status} ${e.response.statusText}`:"<no response>",i=new r(`${n}: ${a}${o?` ${o}`:""}`,e.error?{cause:e.error}:void 0);for(const r of["request","options","response"])Object.defineProperty(i,r,{get:()=>e[r]});for(const[r,p]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(i,r,{get:()=>e.response&&e.response[p]});return i}(e);throw Error.captureStackTrace&&Error.captureStackTrace(t,b),t}const b=async function(s,r={}){const c={request:s,options:u(r,n.defaults,l),response:void 0,error:void 0};let b;if(c.options.method=c.options.method?.toUpperCase(),c.options.onRequest&&await c.options.onRequest(c),"string"==typeof c.request&&(c.options.baseURL&&(c.request=o(c.request,c.options.baseURL)),(c.options.query||c.options.params)&&(c.request=t(c.request,{...c.options.params,...c.options.query}))),c.options.body&&a(c.options.method)&&(!function(e){if(void 0===e)return!1;const o=typeof e;return"string"===o||"number"===o||"boolean"===o||null===o||"object"===o&&(!!Array.isArray(e)||!e.buffer&&(e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON))}(c.options.body)?("pipeTo"in c.options.body&&"function"==typeof c.options.body.pipeTo||"function"==typeof c.options.body.pipe)&&("duplex"in c.options||(c.options.duplex="half")):(c.options.body="string"==typeof c.options.body?c.options.body:JSON.stringify(c.options.body),c.options.headers=new l(c.options.headers||{}),c.options.headers.has("content-type")||c.options.headers.set("content-type","application/json"),c.options.headers.has("accept")||c.options.headers.set("accept","application/json"))),!c.options.signal&&c.options.timeout){const e=new h;b=setTimeout((()=>e.abort()),c.options.timeout),c.options.signal=e.signal}try{c.response=await f(c.request,c.options)}catch(m){return c.error=m,c.options.onRequestError&&await c.options.onRequestError(c),await y(c)}finally{b&&clearTimeout(b)}if(c.response.body&&!d.has(c.response.status)&&"HEAD"!==c.options.method){const o=(c.options.parseResponse?"json":c.options.responseType)||function(e=""){if(!e)return"json";const o=e.split(";").shift()||"";return p.test(o)?"json":i.has(o)||o.startsWith("text/")?"text":"blob"}(c.response.headers.get("content-type")||"");switch(o){case"json":{const o=await c.response.text(),t=c.options.parseResponse||e;c.response._data=t(o);break}case"stream":c.response._data=c.response.body;break;default:c.response._data=await c.response[o]()}}return c.options.onResponse&&await c.options.onResponse(c),!c.options.ignoreResponseError&&c.response.status>=400&&c.response.status<600?(c.options.onResponseError&&await c.options.onResponseError(c),await y(c)):c.response},m=async function(e,o){return(await b(e,o))._data};return m.raw=b,m.native=(...e)=>f(...e),m.create=(e={})=>s({...n,defaults:{...n.defaults,...e}}),m}({fetch:f.fetch||(()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!"))),Headers:f.Headers,AbortController:f.AbortController});var h={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};function y(e){const o=s();return l.create({baseURL:h.VITE_API_BASE_URL??"http://localhost:8080",onRequest:({options:e})=>{o.value&&(e.headers={...e.headers,Authorization:`Bearer ${o.value}`})}})}export{y as u};
