import{_ as e}from"./Des8qgZF.js";import{_ as l}from"./BbyIlV3K.js";import{_ as a}from"./9drODTCA.js";import{_ as s,a as u}from"./CX1M2f4k.js";import{_ as r}from"./BdjI-zdd.js";import{_ as t}from"./BQiUk_jr.js";import{_ as o}from"./CrSly68g.js";import{_ as d}from"./DPBYIlso.js";import{ar as n,S as i,W as m,Z as c,a as p,e as f,o as _,g as v,A as U,l as b,v as y,k as V,s as h,H as g,j as A,C as w,F as j,u as S,D as I,a2 as M}from"../../index-BBZ1hd8o.js";import{c as F}from"./Dcy2DR9j.js";const P=n("userStore",(()=>{const e=i(),l=m(),a=c(),s=p(!1),u=p({username:"",email:"",phone_number:"",role:"",password:"",last_login:"",is_active:!1,is_staff:!1,is_superuser:!1,store:a.loggedStore.id}),r=p([{value:"ultraAdmin",label:"Ultra Admin"},{value:"superAdmin",label:"Super Admin"},{value:"admin",label:"Admin"},{value:"manager",label:"Manager"},{value:"distributer",label:"Distributer"},{value:"retailer",label:"Retailer"}]);return{userDataModel:u,userRoles:r,loading:s,addUser:async()=>{try{s.value=!0,await e.post("/user/",F(u.value,"")),l.success("User added successfully")}catch(a){console.error(a),l.error("Failed to add user")}finally{s.value=!1}},updateUser:async a=>{try{s.value=!0;const r={...u.value};delete r.password,await e.patch(`/user/${a}/`,F(r,"")),l.success("User updated successfully")}catch(r){console.error(r),l.error("Failed to update user")}finally{s.value=!1}},deleteUser:async a=>{try{s.value=!0,await e.delete(`/user/${a}/`),l.success("User deleted successfully")}catch(u){console.error(u),l.error("Failed to delete user")}finally{s.value=!1}}}})),D={class:"columns is-multiline"},N=M(f({__name:"AddUpdateUser",props:{openUserModal:{type:Boolean,default:!1},userId:{default:""}},emits:["update:closeModalHandler","update:callOnSuccess"],setup(n,{emit:f}){P();const M=c(),N=m(),O=i(),R=p(!1),$=n,k=f,x=()=>{k("update:closeModalHandler",!1)},C=p({username:"",email:"",phone_number:"",role:"",password:"",last_login:"",is_active:!1,is_staff:!1,is_superuser:!1,store:M.loggedStore.id}),H=p([{value:"ultraAdmin",label:"Ultra Admin"},{value:"superAdmin",label:"Super Admin"},{value:"admin",label:"Admin"},{value:"manager",label:"Manager"},{value:"distributer",label:"Distributer"},{value:"retailer",label:"Retailer"}]),z=async()=>{try{if(R.value=!0,$.userId){delete C.value.password;await O.patch(`/user/${$.userId}/`,F(C.value,""))}else{await O.post("/user/",F(C.value,""))}k("update:callOnSuccess",null),x(),N.success("User added successfully")}catch(e){console.log(e)}finally{R.value=!1}};return _((()=>{$.userId&&(async()=>{try{R.value=!0;const e=await O.get(`/user/${$.userId}`);C.value=e.data}catch(e){console.log(e)}})()})),(n,i)=>{const m=d,c=o,p=t,f=r,_=s,M=u,F=a,P=l,N=e;return v(),U(N,{is:"form",open:$.openUserModal,size:"medium",actions:"right",title:$.userId?"Update User":"Add User",onSubmit:I(z,["prevent"]),onClose:x},{content:b((()=>[y("div",D,[V(f,{class:"column is-6"},{default:b((()=>[V(m,null,{default:b((()=>[h("Full Name")])),_:1}),V(p,null,{default:b((()=>[V(c,{modelValue:g(C).username,"onUpdate:modelValue":i[0]||(i[0]=e=>g(C).username=e),type:"text",placeholder:"User Full Name"},null,8,["modelValue"])])),_:1})])),_:1}),V(f,{class:"column is-6"},{default:b((()=>[V(m,null,{default:b((()=>[h("Email")])),_:1}),V(p,null,{default:b((()=>[V(c,{modelValue:g(C).email,"onUpdate:modelValue":i[1]||(i[1]=e=>g(C).email=e),type:"mail",placeholder:"email"},null,8,["modelValue"])])),_:1})])),_:1}),V(f,{class:"column is-6"},{default:b((()=>[V(m,null,{default:b((()=>[h("Phone Number")])),_:1}),V(p,null,{default:b((()=>[V(c,{modelValue:g(C).phone_number,"onUpdate:modelValue":i[2]||(i[2]=e=>g(C).phone_number=e),type:"phone",placeholder:"Phone Number"},null,8,["modelValue"])])),_:1})])),_:1}),V(f,{class:"column is-6"},{default:b((()=>[V(f,null,{default:b((()=>[V(m,null,{default:b((()=>[h("User Role")])),_:1}),V(p,null,{default:b((()=>[V(M,{modelValue:g(C).role,"onUpdate:modelValue":i[3]||(i[3]=e=>g(C).role=e)},{default:b((()=>[V(_,{value:""},{default:b((()=>[h(" Select a role ")])),_:1}),(v(!0),A(j,null,w(g(H),((e,l)=>(v(),U(_,{key:l,value:e.value},{default:b((()=>[h(S(e.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),V(f,{class:"column is-6"},{default:b((()=>[V(m,null,{default:b((()=>[h("Password")])),_:1}),V(p,null,{default:b((()=>[V(c,{modelValue:g(C).password,"onUpdate:modelValue":i[4]||(i[4]=e=>g(C).password=e),type:"password",placeholder:"Enter Password"},null,8,["modelValue"])])),_:1})])),_:1}),V(f,{class:"column is-3"},{default:b((()=>[V(m,null,{default:b((()=>[h("Account Status")])),_:1}),V(p,null,{default:b((()=>[V(F,{modelValue:g(C).is_active,"onUpdate:modelValue":i[5]||(i[5]=e=>g(C).is_active=e),color:"primary",label:"Active user"},null,8,["modelValue"])])),_:1})])),_:1}),V(f,{class:"column is-3"},{default:b((()=>[V(m,null,{default:b((()=>[h("In staff")])),_:1}),V(p,null,{default:b((()=>[V(F,{color:"warning",modelValue:g(C).is_staff,"onUpdate:modelValue":i[6]||(i[6]=e=>g(C).is_staff=e),label:"Staff"},null,8,["modelValue"])])),_:1})])),_:1})])])),action:b((()=>[V(P,{type:"submit",color:"primary"},{default:b((()=>[h(S($.userId?"Update User":"Add User"),1)])),_:1})])),cancel:b((()=>[])),_:1},8,["open","title"])}}}),[["__file","AddUpdateUser.vue"]]),O=Object.freeze(Object.defineProperty({__proto__:null,default:N},Symbol.toStringTag,{value:"Module"}));export{N as A,O as a,P as u};
